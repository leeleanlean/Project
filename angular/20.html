<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="initial-scale=1.0,width=device-width,user-scalable=no,maximum-scale=1.0" />
<meta name="format-detection" content="telephone=no,email=no" />
<title>20、angular $location</title>

<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/learn.css">

<!-- js文件引用 -->
<script src="js/angular1.5.5.min.js"></script>
<script src="js/learn.js"></script>

</head>
<body onload="window.location.href=window.location.href+'#/?aaa=111&bbb=222&ccc=333'">

<!-- angular start -->
<div class="angular clearfix" ng-app="app">

	<!-- 左侧导航菜单 start -->
    <div nav id="isMobile"></div>
	<!-- 左侧导航菜单 end -->

	<!-- 右侧内容 start -->
	<div class="content col-sm-12 col-md-10">


		<!-- start -->
		<fieldset class="example" ng-controller="example">
			<legend>获取url的相关方法</legend>

			<button class="btn btn-danger" ng-click="getUrl()">点击获取url相关信息</button>

			<br>
			<br>
			
			<div ng-hide="showUrl">
				<p>
					1. 获取当前完整的url路径(只读):
					<br>
					$scope.absUrl:<span ng-bind="absUrl" class="tipsRed"></span>
				</p>
				<p>
					2. 获取当前url路径(当前url#后面的内容,包括参数和哈希值)(读/写):
					<br>
					$scope.url : <span ng-bind="url" class="tipsRed"></span>
				</p>
				<p>
					3. 获取当前url的子路径(也就是当前url#后面的内容,不包括参数)(读/写):
					<br>
					$scope.path : <span ng-bind="path" class="tipsRed"></span>
				</p>
				<p>
					4. 获取当前url的协议(比如http,https)(只读):
					<br>
					$scope.protocol : <span ng-bind="protocol" class="tipsRed"></span>
				</p>
				<p>
					5. 获取当前url的主机名(只读):
					<br>
					$scope.host : <span ng-bind="host" class="tipsRed"></span>
				</p>
				<p>
					6. 获取当前url的端口(只读):
					<br>
					$scope.port : <span ng-bind="port" class="tipsRed"></span>
				</p>
				<p>
					7. 获取当前url的哈希值(读/写):
					<br>
					$scope.hash : <span ng-bind="hash" class="tipsRed"></span>
				</p>
				<p>
					8.获取当前url的参数的序列化json对象(读/写):
					<br>
					$scope.search : <span ng-bind="search" class="tipsRed"></span>
				</p>
			</div>

			<legend>修改url的相关方法</legend>

			<p>
				$location.url:
				<br>
				<br>
				<button class="btn btn-danger" ng-click="changeUrl()">1. 修改url的子路径(也就是当前url#后面的内容,不包括参数)</button>
				<br>
				<br>
				$location.path:
				<br>
				<br>
				<button class="btn btn-danger" ng-click="changePath()">2. 修改url的子路径部分(也就是当前url#后面的内容,不包括参数)</button>
				<br>
				<br>
				$location.hash:
				<br>
				<br>
				<button class="btn btn-danger" ng-click="changeHash()">3. 修改url的哈希值部分</button>
				<br>
				<br>
				$location.search:
				<br>
				<br>
				<button class="btn btn-danger" ng-click="changeSearch()">修改aaa的参数值为alreadyChangeAAA</button>
				<br>
				<br>
				1/传入两个参数,第一个参数的格式为字符串,第二个参数的格式也是字符串
				<br>
				2/传入两个参数,第一个参数的格式为字符串,第二个参数的格式为数组,数组中的各个值也是字符串或者布尔值
				<br>
				3/传入两个参数,第一个参数为字符串,第二个参数为null:
				<br>
				4/传入一个参数,格式为json对象:

			</p>

			<legend>url改变事件</legend>
			<p>
			开始改变：
			<br>
			$rootScope.$on('$locationChangeStart',function(){
			<br>
		        console.log('开始改变$location');
		    <br>
		    });
			</p>
			<p>
			结束改变：
			<br>
		    $rootScope.$on('$locationChangeSuccess',function(){
		    <br>
		        console.log('结束改变$location');
		    <br>
		    });
		    </p>
			
		</fieldset>
		<!-- end -->

		<!-- 显示导航 -->
		<a href="#isMobile" class="showNav" ng-controller="showNav" ng-click="showNav()">显示导航</a>
		<!-- 显示导航 -->

		<!-- UY BEGIN -->
		<div id="uyan_frame"></div>
		<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2087884"></script>
		<!-- UY END -->
		
	</div>
	<!-- 右侧内容 end -->
</div>
<!-- angular end -->

<script>
app.controller('example', function($scope,$location){

	$scope.showUrl = true;

	$scope.getUrl = function(){

		$scope.showUrl = false;

		$scope.absUrl = $location.absUrl();
		$scope.url = $location.url();
		$scope.path = $location.path();
		$scope.protocol = $location.protocol();
		$scope.host = $location.host();
		$scope.port = $location.port();
		$scope.hash = $location.hash();
		$scope.search = $location.search();

	}

	// 修改URL
	$scope.changeUrl = function(){
		$location.url('?/url/111=aaa&222=bbb&333=ccc');
	}
	$scope.changePath = function(){
		$location.path('/path/111=aaa&222=bbb&333=ccc');
	}
	$scope.changeHash = function(){
		$location.hash('myHash');
	}
	$scope.changeSearch = function(){
		$location.search('aaa',"alreadyChangeAAA");
	}

})
</script>

</body>
</html>